function [x,w] = patterson_rule ( order, a, b)

%*****************************************************************************80
%
%% PATTERSON_RULE generates a Gauss-Patterson rule.
%
%  Discussion:
%
%    This program computes a standard Gauss-Patterson quadrature rule
%    and writes it to a file.
%
%  Usage:
%
%    patterson_rule ( order, a, b, 'filename' )
%
%    where
%
%    * ORDER is the number of points in the rule, and must be
%      1, 3, 7, 15, 31, 63, 127 or 255;
%    * A is the left endpoint;
%    * B is the right endpoint;
%    * FILENAME is the "root name" of the output files.
%
%  Licensing:
%
%    This code is distributed under the GNU LGPL license.
%
%  Modified:
%
%    21 February 2010
%
%  Author:
%
%    John Burkardt
%

%% The following code initially was uncommented
%   timestamp ( );
%   fprintf ( 1, '\n' );
%   fprintf ( 1, 'PATTERSON_RULE\n' );
%   fprintf ( 1, '  MATLAB version\n' );
%   fprintf ( 1, '\n' );
%   fprintf ( 1, '  Compute a Gauss-Patterson rule for approximating\n' );
%   fprintf ( 1, '\n' );
%   fprintf ( 1, '    Integral ( A <= x <= B ) f(x) dx\n' );
%   fprintf ( 1, '\n' );
%   fprintf ( 1, '  of order ORDER.\n' );
%   fprintf ( 1, '\n' );
%   fprintf ( 1, '  The user specifies ORDER, A, B, and FILENAME.\n' );
%   fprintf ( 1, '\n' );
%   fprintf ( 1, '  ORDER is 1, 3, 7, 15, 31, 63, 127 or 255.\n' );
%   fprintf ( 1, '\n' );
%   fprintf ( 1, '  A is the left endpoint;\n' );
%   fprintf ( 1, '\n' );
%   fprintf ( 1, '  B is the right endpoint;\n' );
%   fprintf ( 1, '\n' );
%   fprintf ( 1, '  FILENAME is used to generate 3 files:\n' );
%   fprintf ( 1, '\n' );
%   fprintf ( 1, '    filename_w.txt - the weight file\n' );
%   fprintf ( 1, '    filename_x.txt - the abscissa file.\n' );
%   fprintf ( 1, '    filename_r.txt - the region file.\n' );
%%
%
%  Get ORDER.
%
  if ( 1 <= nargin )

  else
    fprintf ( 1, '\n' );
    order = input ( '  Enter the rule order ORDER:  ' );
  end
    
  if ( ~order_check ( order ) )
    fprintf ( 1, '\n' );
    fprintf ( 1, 'PATTERSON_RULE - Fatal error!' );
    fprintf ( 1, '  The value of ORDER was not acceptable.\n' );
    fprintf ( 1, '  Acceptable values are 1, 3, 7, 15, 31, 63, 127 or 255.\n' );
    error ( 'PATTERSON_RULE - Fatal error!\n' );
  end
%
%  Get A.
%
  if ( 2 <= nargin )

  else
    a = input ( '  Enter the left endpoint A:  ' );
  end
%
%  Get B.
%
  if ( 3 <= nargin )

  else
    b = input ( '  Enter the right endpoint B:  ' );
  end
%
%  Input summary.
%

%% The following code initially was uncommented
%   fprintf ( 1, '\n' );
%   fprintf ( 1, '  ORDER = %d\n', order );
%   fprintf ( 1, '  A = %f\n', a );
%   fprintf ( 1, '  B = %f\n', b );
%   fprintf ( 1, '  FILENAME = "%s".\n', filename );
%%
%
%  Construct the rule.
%
  r = [ a, b ]';
  [ x, w ] = patterson_set ( order );
%
%  Rescale the rule.
%
  [ x, w ] = rescale ( a, b, x, w );
%
%  Write the rule.
%
  %rule_write ( order, filename, x, w, r );
%
%  Terminate.
%

%% The following code initially was uncommented
%   fprintf ( 1,  '\n' );
%   fprintf ( 1,  'PATTERSON_RULE:\n' );
%   fprintf ( 1,  '  Normal end of execution.\n' );
%   fprintf ( 1,  '\n' );
%   timestamp ( );
%%

  return
end
function check = order_check ( order )

%*****************************************************************************80
%
%% ORDER_CHECK checks the value of ORDER.
%
%  Licensing:
%
%    This code is distributed under the GNU LGPL license.
%
%  Modified:
%
%    17 December 2009
%
%  Author:
%
%    John Burkardt
%
%  Parameters:
%
%    Input, integer ORDER, the requested order.
%
%    Output, logical CHECK, is TRUE if the requested order is acceptable.
%
  check = ( order ==   1 ) | ...
          ( order ==   3 ) | ...
          ( order ==   7 ) | ...
          ( order ==  15 ) | ...
          ( order ==  31 ) | ...
          ( order ==  63 ) | ...
          ( order == 127 ) | ...
          ( order == 255 );

  return
end
function [ x, w ] = patterson_set ( order )

%*****************************************************************************80
%
%% PATTERSON_SET sets abscissas and weights for Gauss-Patterson quadrature.
%
%  Discussion:
%
%    The integration interval is [ -1, 1 ].
%
%    The weight function is w(x) = 1.0.
%
%    The integral to approximate:
%
%      Integral ( -1 <= X <= 1 ) F(X) dX
%
%    The quadrature rule:
%
%      Sum ( 1 <= I <= ORDER ) W(I) * F ( X(I) )
%
%    The zeroth rule, of order 1, is the standard Gauss-Legendre rule.
%
%    The first rule, of order 3, is the standard Gauss-Legendre rule.
%
%    The second rule, of order 7, includes the abscissas of the previous
%    rule.
%
%    Each subsequent rule is nested in a similar way.  Rules are available
%    of orders 1, 3, 7, 15, 31, 63, 127 or 255.
%
%  Licensing:
%
%    This code is distributed under the GNU LGPL license.
%
%  Modified:
%
%    17 December 2009
%
%  Author:
%
%    John Burkardt
%
%  Reference:
%
%    Prem Kythe, Michael Schaeferkotter,
%    Handbook of Computational Methods for Integration,
%    Chapman and Hall, 2004,
%    ISBN: 1-58488-428-2,
%    LC: QA299.3.K98.
%
%    Thomas Patterson,
%    The Optimal Addition of Points to Quadrature Formulae,
%    Mathematics of Computation,
%    Volume 22, Number 104, October 1968, pages 847-856.
%
%  Parameters:
%
%    Input, integer ORDER, the order of the rule.
%    ORDER must be 1, 3, 7, 15, 31, 63, 127 or 255.
%
%    Output, real X(ORDER), the abscissas of the rule.
%
%    Output, real W(ORDER), the weights of the rule.
%    The weights are positive, symmetric and should sum to 2.
%
  x = zeros ( order, 1 );
  w = zeros ( order, 1 );

  if ( order == 1 )

    x(1) =   0.0;

    w(1) = 2.0;

  elseif ( order == 3 )

    x(1) = -0.77459666924148337704;
    x(2) =  0.0;
    x(3) =  0.77459666924148337704;

    w(1) = 0.555555555555555555556;
    w(2) = 0.888888888888888888889;
    w(3) = 0.555555555555555555556;

  elseif ( order == 7 )

    x(1) = -0.96049126870802028342;
    x(2) = -0.77459666924148337704;
    x(3) = -0.43424374934680255800;
    x(4) =  0.0;
    x(5) =  0.43424374934680255800;
    x(6) =  0.77459666924148337704;
    x(7) =  0.96049126870802028342;

    w(1) = 0.104656226026467265194;
    w(2) = 0.268488089868333440729;
    w(3) = 0.401397414775962222905;
    w(4) = 0.450916538658474142345;
    w(5) = 0.401397414775962222905;
    w(6) = 0.268488089868333440729;
    w(7) = 0.104656226026467265194;

  elseif ( order == 15 )

    x( 1) = -0.99383196321275502221;
    x( 2) = -0.96049126870802028342;
    x( 3) = -0.88845923287225699889;
    x( 4) = -0.77459666924148337704;
    x( 5) = -0.62110294673722640294;
    x( 6) = -0.43424374934680255800;
    x( 7) = -0.22338668642896688163;
    x( 8) =  0.0;
    x( 9) =  0.22338668642896688163;
    x(10) =  0.43424374934680255800;
    x(11) =  0.62110294673722640294;
    x(12) =  0.77459666924148337704;
    x(13) =  0.88845923287225699889;
    x(14) =  0.96049126870802028342;
    x(15) =  0.99383196321275502221;

    w( 1) = 0.0170017196299402603390;
    w( 2) = 0.0516032829970797396969;
    w( 3) = 0.0929271953151245376859;
    w( 4) = 0.134415255243784220360;
    w( 5) = 0.171511909136391380787;
    w( 6) = 0.200628529376989021034;
    w( 7) = 0.219156858401587496404;
    w( 8) = 0.225510499798206687386;
    w( 9) = 0.219156858401587496404;
    w(10) = 0.200628529376989021034;
    w(11) = 0.171511909136391380787;
    w(12) = 0.134415255243784220360;
    w(13) = 0.0929271953151245376859;
    w(14) = 0.0516032829970797396969;
    w(15) = 0.0170017196299402603390;

  elseif ( order == 31 )

    x( 1) = -0.99909812496766759766;
    x( 2) = -0.99383196321275502221;
    x( 3) = -0.98153114955374010687;
    x( 4) = -0.96049126870802028342;
    x( 5) = -0.92965485742974005667;
    x( 6) = -0.88845923287225699889;
    x( 7) = -0.83672593816886873550;
    x( 8) = -0.77459666924148337704;
    x( 9) = -0.70249620649152707861;
    x(10) = -0.62110294673722640294;
    x(11) = -0.53131974364437562397;
    x(12) = -0.43424374934680255800;
    x(13) = -0.33113539325797683309;
    x(14) = -0.22338668642896688163;
    x(15) = -0.11248894313318662575;
    x(16) =  0.0;
    x(17) =  0.11248894313318662575;
    x(18) =  0.22338668642896688163;
    x(19) =  0.33113539325797683309;
    x(20) =  0.43424374934680255800;
    x(21) =  0.53131974364437562397;
    x(22) =  0.62110294673722640294;
    x(23) =  0.70249620649152707861;
    x(24) =  0.77459666924148337704;
    x(25) =  0.83672593816886873550;
    x(26) =  0.88845923287225699889;
    x(27) =  0.92965485742974005667;
    x(28) =  0.96049126870802028342;
    x(29) =  0.98153114955374010687;
    x(30) =  0.99383196321275502221;
    x(31) =  0.99909812496766759766;

    w( 1) = 0.00254478079156187441540;
    w( 2) = 0.00843456573932110624631;
    w( 3) = 0.0164460498543878109338;
    w( 4) = 0.0258075980961766535646;
    w( 5) = 0.0359571033071293220968;
    w( 6) = 0.0464628932617579865414;
    w( 7) = 0.0569795094941233574122;
    w( 8) = 0.0672077542959907035404;
    w( 9) = 0.0768796204990035310427;
    w(10) = 0.0857559200499903511542;
    w(11) = 0.0936271099812644736167;
    w(12) = 0.100314278611795578771;
    w(13) = 0.105669893580234809744;
    w(14) = 0.109578421055924638237;
    w(15) = 0.111956873020953456880;
    w(16) = 0.112755256720768691607;
    w(17) = 0.111956873020953456880;
    w(18) = 0.109578421055924638237;
    w(19) = 0.105669893580234809744;
    w(20) = 0.100314278611795578771;
    w(21) = 0.0936271099812644736167;
    w(22) = 0.0857559200499903511542;
    w(23) = 0.0768796204990035310427;
    w(24) = 0.0672077542959907035404;
    w(25) = 0.0569795094941233574122;
    w(26) = 0.0464628932617579865414;
    w(27) = 0.0359571033071293220968;
    w(28) = 0.0258075980961766535646;
    w(29) = 0.0164460498543878109338;
    w(30) = 0.00843456573932110624631;
    w(31) = 0.00254478079156187441540;

  elseif ( order == 63 )

    x( 1) = -0.99987288812035761194;
    x( 2) = -0.99909812496766759766;
    x( 3) = -0.99720625937222195908;
    x( 4) = -0.99383196321275502221;
    x( 5) = -0.98868475754742947994;
    x( 6) = -0.98153114955374010687;
    x( 7) = -0.97218287474858179658;
    x( 8) = -0.96049126870802028342;
    x( 9) = -0.94634285837340290515;
    x(10) = -0.92965485742974005667;
    x(11) = -0.91037115695700429250;
    x(12) = -0.88845923287225699889;
    x(13) = -0.86390793819369047715;
    x(14) = -0.83672593816886873550;
    x(15) = -0.80694053195021761186;
    x(16) = -0.77459666924148337704;
    x(17) = -0.73975604435269475868;
    x(18) = -0.70249620649152707861;
    x(19) = -0.66290966002478059546;
    x(20) = -0.62110294673722640294;
    x(21) = -0.57719571005204581484;
    x(22) = -0.53131974364437562397;
    x(23) = -0.48361802694584102756;
    x(24) = -0.43424374934680255800;
    x(25) = -0.38335932419873034692;
    x(26) = -0.33113539325797683309;
    x(27) = -0.27774982202182431507;
    x(28) = -0.22338668642896688163;
    x(29) = -0.16823525155220746498;
    x(30) = -0.11248894313318662575;
    x(31) = -0.056344313046592789972;
    x(32) =  0.0;
    x(33) =  0.056344313046592789972;
    x(34) =  0.11248894313318662575;
    x(35) =  0.16823525155220746498;
    x(36) =  0.22338668642896688163;
    x(37) =  0.27774982202182431507;
    x(38) =  0.33113539325797683309;
    x(39) =  0.38335932419873034692;
    x(40) =  0.43424374934680255800;
    x(41) =  0.48361802694584102756;
    x(42) =  0.53131974364437562397;
    x(43) =  0.57719571005204581484;
    x(44) =  0.62110294673722640294;
    x(45) =  0.66290966002478059546;
    x(46) =  0.70249620649152707861;
    x(47) =  0.73975604435269475868;
    x(48) =  0.77459666924148337704;
    x(49) =  0.80694053195021761186;
    x(50) =  0.83672593816886873550;
    x(51) =  0.86390793819369047715;
    x(52) =  0.88845923287225699889;
    x(53) =  0.91037115695700429250;
    x(54) =  0.92965485742974005667;
    x(55) =  0.94634285837340290515;
    x(56) =  0.96049126870802028342;
    x(57) =  0.97218287474858179658;
    x(58) =  0.98153114955374010687;
    x(59) =  0.98868475754742947994;
    x(60) =  0.99383196321275502221;
    x(61) =  0.99720625937222195908;
    x(62) =  0.99909812496766759766;
    x(63) =  0.99987288812035761194;

    w( 1) = 0.000363221481845530659694;
    w( 2) = 0.00126515655623006801137;
    w( 3) = 0.00257904979468568827243;
    w( 4) = 0.00421763044155885483908;
    w( 5) = 0.00611550682211724633968;
    w( 6) = 0.00822300795723592966926;
    w( 7) = 0.0104982469096213218983;
    w( 8) = 0.0129038001003512656260;
    w( 9) = 0.0154067504665594978021;
    w(10) = 0.0179785515681282703329;
    w(11) = 0.0205942339159127111492;
    w(12) = 0.0232314466399102694433;
    w(13) = 0.0258696793272147469108;
    w(14) = 0.0284897547458335486125;
    w(15) = 0.0310735511116879648799;
    w(16) = 0.0336038771482077305417;
    w(17) = 0.0360644327807825726401;
    w(18) = 0.0384398102494555320386;
    w(19) = 0.0407155101169443189339;
    w(20) = 0.0428779600250077344929;
    w(21) = 0.0449145316536321974143;
    w(22) = 0.0468135549906280124026;
    w(23) = 0.0485643304066731987159;
    w(24) = 0.0501571393058995374137;
    w(25) = 0.0515832539520484587768;
    w(26) = 0.0528349467901165198621;
    w(27) = 0.0539054993352660639269;
    w(28) = 0.0547892105279628650322;
    w(29) = 0.0554814043565593639878;
    w(30) = 0.0559784365104763194076;
    w(31) = 0.0562776998312543012726;
    w(32) = 0.0563776283603847173877;
    w(33) = 0.0562776998312543012726;
    w(34) = 0.0559784365104763194076;
    w(35) = 0.0554814043565593639878;
    w(36) = 0.0547892105279628650322;
    w(37) = 0.0539054993352660639269;
    w(38) = 0.0528349467901165198621;
    w(39) = 0.0515832539520484587768;
    w(40) = 0.0501571393058995374137;
    w(41) = 0.0485643304066731987159;
    w(42) = 0.0468135549906280124026;
    w(43) = 0.0449145316536321974143;
    w(44) = 0.0428779600250077344929;
    w(45) = 0.0407155101169443189339;
    w(46) = 0.0384398102494555320386;
    w(47) = 0.0360644327807825726401;
    w(48) = 0.0336038771482077305417;
    w(49) = 0.0310735511116879648799;
    w(50) = 0.0284897547458335486125;
    w(51) = 0.0258696793272147469108;
    w(52) = 0.0232314466399102694433;
    w(53) = 0.0205942339159127111492;
    w(54) = 0.0179785515681282703329;
    w(55) = 0.0154067504665594978021;
    w(56) = 0.0129038001003512656260;
    w(57) = 0.0104982469096213218983;
    w(58) = 0.00822300795723592966926;
    w(59) = 0.00611550682211724633968;
    w(60) = 0.00421763044155885483908;
    w(61) = 0.00257904979468568827243;
    w(62) = 0.00126515655623006801137;
    w(63) = 0.000363221481845530659694;

  elseif ( order == 127 )

    x(  1) = -0.99998243035489159858;
    x(  2) = -0.99987288812035761194;
    x(  3) = -0.99959879967191068325;
    x(  4) = -0.99909812496766759766;
    x(  5) = -0.99831663531840739253;
    x(  6) = -0.99720625937222195908;
    x(  7) = -0.99572410469840718851;
    x(  8) = -0.99383196321275502221;
    x(  9) = -0.99149572117810613240;
    x( 10) = -0.98868475754742947994;
    x( 11) = -0.98537149959852037111;
    x( 12) = -0.98153114955374010687;
    x( 13) = -0.97714151463970571416;
    x( 14) = -0.97218287474858179658;
    x( 15) = -0.96663785155841656709;
    x( 16) = -0.96049126870802028342;
    x( 17) = -0.95373000642576113641;
    x( 18) = -0.94634285837340290515;
    x( 19) = -0.93832039777959288365;
    x( 20) = -0.92965485742974005667;
    x( 21) = -0.92034002547001242073;
    x( 22) = -0.91037115695700429250;
    x( 23) = -0.89974489977694003664;
    x( 24) = -0.88845923287225699889;
    x( 25) = -0.87651341448470526974;
    x( 26) = -0.86390793819369047715;
    x( 27) = -0.85064449476835027976;
    x( 28) = -0.83672593816886873550;
    x( 29) = -0.82215625436498040737;
    x( 30) = -0.80694053195021761186;
    x( 31) = -0.79108493379984836143;
    x( 32) = -0.77459666924148337704;
    x( 33) = -0.75748396638051363793;
    x( 34) = -0.73975604435269475868;
    x( 35) = -0.72142308537009891548;
    x( 36) = -0.70249620649152707861;
    x( 37) = -0.68298743109107922809;
    x( 38) = -0.66290966002478059546;
    x( 39) = -0.64227664250975951377;
    x( 40) = -0.62110294673722640294;
    x( 41) = -0.59940393024224289297;
    x( 42) = -0.57719571005204581484;
    x( 43) = -0.55449513263193254887;
    x( 44) = -0.53131974364437562397;
    x( 45) = -0.50768775753371660215;
    x( 46) = -0.48361802694584102756;
    x( 47) = -0.45913001198983233287;
    x( 48) = -0.43424374934680255800;
    x( 49) = -0.40897982122988867241;
    x( 50) = -0.38335932419873034692;
    x( 51) = -0.35740383783153215238;
    x( 52) = -0.33113539325797683309;
    x( 53) = -0.30457644155671404334;
    x( 54) = -0.27774982202182431507;
    x( 55) = -0.25067873030348317661;
    x( 56) = -0.22338668642896688163;
    x( 57) = -0.19589750271110015392;
    x( 58) = -0.16823525155220746498;
    x( 59) = -0.14042423315256017459;
    x( 60) = -0.11248894313318662575;
    x( 61) = -0.084454040083710883710;
    x( 62) = -0.056344313046592789972;
    x( 63) = -0.028184648949745694339;
    x( 64) =  0.0;
    x( 65) =  0.028184648949745694339;
    x( 66) =  0.056344313046592789972;
    x( 67) =  0.084454040083710883710;
    x( 68) =  0.11248894313318662575;
    x( 69) =  0.14042423315256017459;
    x( 70) =  0.16823525155220746498;
    x( 71) =  0.19589750271110015392;
    x( 72) =  0.22338668642896688163;
    x( 73) =  0.25067873030348317661;
    x( 74) =  0.27774982202182431507;
    x( 75) =  0.30457644155671404334;
    x( 76) =  0.33113539325797683309;
    x( 77) =  0.35740383783153215238;
    x( 78) =  0.38335932419873034692;
    x( 79) =  0.40897982122988867241;
    x( 80) =  0.43424374934680255800;
    x( 81) =  0.45913001198983233287;
    x( 82) =  0.48361802694584102756;
    x( 83) =  0.50768775753371660215;
    x( 84) =  0.53131974364437562397;
    x( 85) =  0.55449513263193254887;
    x( 86) =  0.57719571005204581484;
    x( 87) =  0.59940393024224289297;
    x( 88) =  0.62110294673722640294;
    x( 89) =  0.64227664250975951377;
    x( 90) =  0.66290966002478059546;
    x( 91) =  0.68298743109107922809;
    x( 92) =  0.70249620649152707861;
    x( 93) =  0.72142308537009891548;
    x( 94) =  0.73975604435269475868;
    x( 95) =  0.75748396638051363793;
    x( 96) =  0.77459666924148337704;
    x( 97) =  0.79108493379984836143;
    x( 98) =  0.80694053195021761186;
    x( 99) =  0.82215625436498040737;
    x(100) =  0.83672593816886873550;
    x(101) =  0.85064449476835027976;
    x(102) =  0.86390793819369047715;
    x(103) =  0.87651341448470526974;
    x(104) =  0.88845923287225699889;
    x(105) =  0.89974489977694003664;
    x(106) =  0.91037115695700429250;
    x(107) =  0.92034002547001242073;
    x(108) =  0.92965485742974005667;
    x(109) =  0.93832039777959288365;
    x(110) =  0.94634285837340290515;
    x(111) =  0.95373000642576113641;
    x(112) =  0.96049126870802028342;
    x(113) =  0.96663785155841656709;
    x(114) =  0.97218287474858179658;
    x(115) =  0.97714151463970571416;
    x(116) =  0.98153114955374010687;
    x(117) =  0.98537149959852037111;
    x(118) =  0.98868475754742947994;
    x(119) =  0.99149572117810613240;
    x(120) =  0.99383196321275502221;
    x(121) =  0.99572410469840718851;
    x(122) =  0.99720625937222195908;
    x(123) =  0.99831663531840739253;
    x(124) =  0.99909812496766759766;
    x(125) =  0.99959879967191068325;
    x(126) =  0.99987288812035761194;
    x(127) =  0.99998243035489159858;

    w(  1) = 0.0000505360952078625176247;
    w(  2) = 0.000180739564445388357820;
    w(  3) = 0.000377746646326984660274;
    w(  4) = 0.000632607319362633544219;
    w(  5) = 0.000938369848542381500794;
    w(  6) = 0.00128952408261041739210;
    w(  7) = 0.00168114286542146990631;
    w(  8) = 0.00210881524572663287933;
    w(  9) = 0.00256876494379402037313;
    w( 10) = 0.00305775341017553113613;
    w( 11) = 0.00357289278351729964938;
    w( 12) = 0.00411150397865469304717;
    w( 13) = 0.00467105037211432174741;
    w( 14) = 0.00524912345480885912513;
    w( 15) = 0.00584344987583563950756;
    w( 16) = 0.00645190005017573692280;
    w( 17) = 0.00707248999543355546805;
    w( 18) = 0.00770337523327974184817;
    w( 19) = 0.00834283875396815770558;
    w( 20) = 0.00898927578406413572328;
    w( 21) = 0.00964117772970253669530;
    w( 22) = 0.0102971169579563555237;
    w( 23) = 0.0109557333878379016480;
    w( 24) = 0.0116157233199551347270;
    w( 25) = 0.0122758305600827700870;
    w( 26) = 0.0129348396636073734547;
    w( 27) = 0.0135915710097655467896;
    w( 28) = 0.0142448773729167743063;
    w( 29) = 0.0148936416648151820348;
    w( 30) = 0.0155367755558439824399;
    w( 31) = 0.0161732187295777199419;
    w( 32) = 0.0168019385741038652709;
    w( 33) = 0.0174219301594641737472;
    w( 34) = 0.0180322163903912863201;
    w( 35) = 0.0186318482561387901863;
    w( 36) = 0.0192199051247277660193;
    w( 37) = 0.0197954950480974994880;
    w( 38) = 0.0203577550584721594669;
    w( 39) = 0.0209058514458120238522;
    w( 40) = 0.0214389800125038672465;
    w( 41) = 0.0219563663053178249393;
    w( 42) = 0.0224572658268160987071;
    w( 43) = 0.0229409642293877487608;
    w( 44) = 0.0234067774953140062013;
    w( 45) = 0.0238540521060385400804;
    w( 46) = 0.0242821652033365993580;
    w( 47) = 0.0246905247444876769091;
    w( 48) = 0.0250785696529497687068;
    w( 49) = 0.0254457699654647658126;
    w( 50) = 0.0257916269760242293884;
    w( 51) = 0.0261156733767060976805;
    w( 52) = 0.0264174733950582599310;
    w( 53) = 0.0266966229274503599062;
    w( 54) = 0.0269527496676330319634;
    w( 55) = 0.0271855132296247918192;
    w( 56) = 0.0273946052639814325161;
    w( 57) = 0.0275797495664818730349;
    w( 58) = 0.0277407021782796819939;
    w( 59) = 0.0278772514766137016085;
    w( 60) = 0.0279892182552381597038;
    w( 61) = 0.0280764557938172466068;
    w( 62) = 0.0281388499156271506363;
    w( 63) = 0.0281763190330166021307;
    w( 64) = 0.0281888141801923586938;
    w( 65) = 0.0281763190330166021307;
    w( 66) = 0.0281388499156271506363;
    w( 67) = 0.0280764557938172466068;
    w( 68) = 0.0279892182552381597038;
    w( 69) = 0.0278772514766137016085;
    w( 70) = 0.0277407021782796819939;
    w( 71) = 0.0275797495664818730349;
    w( 72) = 0.0273946052639814325161;
    w( 73) = 0.0271855132296247918192;
    w( 74) = 0.0269527496676330319634;
    w( 75) = 0.0266966229274503599062;
    w( 76) = 0.0264174733950582599310;
    w( 77) = 0.0261156733767060976805;
    w( 78) = 0.0257916269760242293884;
    w( 79) = 0.0254457699654647658126;
    w( 80) = 0.0250785696529497687068;
    w( 81) = 0.0246905247444876769091;
    w( 82) = 0.0242821652033365993580;
    w( 83) = 0.0238540521060385400804;
    w( 84) = 0.0234067774953140062013;
    w( 85) = 0.0229409642293877487608;
    w( 86) = 0.0224572658268160987071;
    w( 87) = 0.0219563663053178249393;
    w( 88) = 0.0214389800125038672465;
    w( 89) = 0.0209058514458120238522;
    w( 90) = 0.0203577550584721594669;
    w( 91) = 0.0197954950480974994880;
    w( 92) = 0.0192199051247277660193;
    w( 93) = 0.0186318482561387901863;
    w( 94) = 0.0180322163903912863201;
    w( 95) = 0.0174219301594641737472;
    w( 96) = 0.0168019385741038652709;
    w( 97) = 0.0161732187295777199419;
    w( 98) = 0.0155367755558439824399;
    w( 99) = 0.0148936416648151820348;
    w(100) = 0.0142448773729167743063;
    w(101) = 0.0135915710097655467896;
    w(102) = 0.0129348396636073734547;
    w(103) = 0.0122758305600827700870;
    w(104) = 0.0116157233199551347270;
    w(105) = 0.0109557333878379016480;
    w(106) = 0.0102971169579563555237;
    w(107) = 0.00964117772970253669530;
    w(108) = 0.00898927578406413572328;
    w(109) = 0.00834283875396815770558;
    w(110) = 0.00770337523327974184817;
    w(111) = 0.00707248999543355546805;
    w(112) = 0.00645190005017573692280;
    w(113) = 0.00584344987583563950756;
    w(114) = 0.00524912345480885912513;
    w(115) = 0.00467105037211432174741;
    w(116) = 0.00411150397865469304717;
    w(117) = 0.00357289278351729964938;
    w(118) = 0.00305775341017553113613;
    w(119) = 0.00256876494379402037313;
    w(120) = 0.00210881524572663287933;
    w(121) = 0.00168114286542146990631;
    w(122) = 0.00128952408261041739210;
    w(123) = 0.000938369848542381500794;
    w(124) = 0.000632607319362633544219;
    w(125) = 0.000377746646326984660274;
    w(126) = 0.000180739564445388357820;
    w(127) = 0.0000505360952078625176247;

  elseif ( order == 255 )

    x(  1) = -0.99999759637974846462E+00;
    x(  2) = -0.99998243035489159858E+00;
    x(  3) = -0.99994399620705437576E+00;
    x(  4) = -0.99987288812035761194E+00;
    x(  5) = -0.99976049092443204733E+00;
    x(  6) = -0.99959879967191068325E+00;
    x(  7) = -0.99938033802502358193E+00;
    x(  8) = -0.99909812496766759766E+00;
    x(  9) = -0.99874561446809511470E+00;
    x( 10) = -0.99831663531840739253E+00;
    x( 11) = -0.99780535449595727456E+00;
    x( 12) = -0.99720625937222195908E+00;
    x( 13) = -0.99651414591489027385E+00;
    x( 14) = -0.99572410469840718851E+00;
    x( 15) = -0.99483150280062100052E+00;
    x( 16) = -0.99383196321275502221E+00;
    x( 17) = -0.99272134428278861533E+00;
    x( 18) = -0.99149572117810613240E+00;
    x( 19) = -0.99015137040077015918E+00;
    x( 20) = -0.98868475754742947994E+00;
    x( 21) = -0.98709252795403406719E+00;
    x( 22) = -0.98537149959852037111E+00;
    x( 23) = -0.98351865757863272876E+00;
    x( 24) = -0.98153114955374010687E+00;
    x( 25) = -0.97940628167086268381E+00;
    x( 26) = -0.97714151463970571416E+00;
    x( 27) = -0.97473445975240266776E+00;
    x( 28) = -0.97218287474858179658E+00;
    x( 29) = -0.96948465950245923177E+00;
    x( 30) = -0.96663785155841656709E+00;
    x( 31) = -0.96364062156981213252E+00;
    x( 32) = -0.96049126870802028342E+00;
    x( 33) = -0.95718821610986096274E+00;
    x( 34) = -0.95373000642576113641E+00;
    x( 35) = -0.95011529752129487656E+00;
    x( 36) = -0.94634285837340290515E+00;
    x( 37) = -0.94241156519108305981E+00;
    x( 38) = -0.93832039777959288365E+00;
    x( 39) = -0.93406843615772578800E+00;
    x( 40) = -0.92965485742974005667E+00;
    x( 41) = -0.92507893290707565236E+00;
    x( 42) = -0.92034002547001242073E+00;
    x( 43) = -0.91543758715576504064E+00;
    x( 44) = -0.91037115695700429250E+00;
    x( 45) = -0.90514035881326159519E+00;
    x( 46) = -0.89974489977694003664E+00;
    x( 47) = -0.89418456833555902286E+00;
    x( 48) = -0.88845923287225699889E+00;
    x( 49) = -0.88256884024734190684E+00;
    x( 50) = -0.87651341448470526974E+00;
    x( 51) = -0.87029305554811390585E+00;
    x( 52) = -0.86390793819369047715E+00;
    x( 53) = -0.85735831088623215653E+00;
    x( 54) = -0.85064449476835027976E+00;
    x( 55) = -0.84376688267270860104E+00;
    x( 56) = -0.83672593816886873550E+00;
    x( 57) = -0.82952219463740140018E+00;
    x( 58) = -0.82215625436498040737E+00;
    x( 59) = -0.81462878765513741344E+00;
    x( 60) = -0.80694053195021761186E+00;
    x( 61) = -0.79909229096084140180E+00;
    x( 62) = -0.79108493379984836143E+00;
    x( 63) = -0.78291939411828301639E+00;
    x( 64) = -0.77459666924148337704E+00;
    x( 65) = -0.76611781930376009072E+00;
    x( 66) = -0.75748396638051363793E+00;
    x( 67) = -0.74869629361693660282E+00;
    x( 68) = -0.73975604435269475868E+00;
    x( 69) = -0.73066452124218126133E+00;
    x( 70) = -0.72142308537009891548E+00;
    x( 71) = -0.71203315536225203459E+00;
    x( 72) = -0.70249620649152707861E+00;
    x( 73) = -0.69281376977911470289E+00;
    x( 74) = -0.68298743109107922809E+00;
    x( 75) = -0.67301883023041847920E+00;
    x( 76) = -0.66290966002478059546E+00;
    x( 77) = -0.65266166541001749610E+00;
    x( 78) = -0.64227664250975951377E+00;
    x( 79) = -0.63175643771119423041E+00;
    x( 80) = -0.62110294673722640294E+00;
    x( 81) = -0.61031811371518640016E+00;
    x( 82) = -0.59940393024224289297E+00;
    x( 83) = -0.58836243444766254143E+00;
    x( 84) = -0.57719571005204581484E+00;
    x( 85) = -0.56590588542365442262E+00;
    x( 86) = -0.55449513263193254887E+00;
    x( 87) = -0.54296566649831149049E+00;
    x( 88) = -0.53131974364437562397E+00;
    x( 89) = -0.51955966153745702199E+00;
    x( 90) = -0.50768775753371660215E+00;
    x( 91) = -0.49570640791876146017E+00;
    x( 92) = -0.48361802694584102756E+00;
    x( 93) = -0.47142506587165887693E+00;
    x( 94) = -0.45913001198983233287E+00;
    x( 95) = -0.44673538766202847374E+00;
    x( 96) = -0.43424374934680255800E+00;
    x( 97) = -0.42165768662616330006E+00;
    x( 98) = -0.40897982122988867241E+00;
    x( 99) = -0.39621280605761593918E+00;
    x(100) = -0.38335932419873034692E+00;
    x(101) = -0.37042208795007823014E+00;
    x(102) = -0.35740383783153215238E+00;
    x(103) = -0.34430734159943802278E+00;
    x(104) = -0.33113539325797683309E+00;
    x(105) = -0.31789081206847668318E+00;
    x(106) = -0.30457644155671404334E+00;
    x(107) = -0.29119514851824668196E+00;
    x(108) = -0.27774982202182431507E+00;
    x(109) = -0.26424337241092676194E+00;
    x(110) = -0.25067873030348317661E+00;
    x(111) = -0.23705884558982972721E+00;
    x(112) = -0.22338668642896688163E+00;
    x(113) = -0.20966523824318119477E+00;
    x(114) = -0.19589750271110015392E+00;
    x(115) = -0.18208649675925219825E+00;
    x(116) = -0.16823525155220746498E+00;
    x(117) = -0.15434681148137810869E+00;
    x(118) = -0.14042423315256017459E+00;
    x(119) = -0.12647058437230196685E+00;
    x(120) = -0.11248894313318662575E+00;
    x(121) = -0.098482396598119202090E+00;
    x(122) = -0.084454040083710883710E+00;
    x(123) = -0.070406976042855179063E+00;
    x(124) = -0.056344313046592789972E+00;
    x(125) = -0.042269164765363603212E+00;
    x(126) = -0.028184648949745694339E+00;
    x(127) = -0.014093886410782462614E+00;
    x(128) =  0.0E+00;
    x(129) =  0.014093886410782462614E+00;
    x(130) =  0.028184648949745694339E+00;
    x(131) =  0.042269164765363603212E+00;
    x(132) =  0.056344313046592789972E+00;
    x(133) =  0.070406976042855179063E+00;
    x(134) =  0.084454040083710883710E+00;
    x(135) =  0.098482396598119202090E+00;
    x(136) =  0.11248894313318662575E+00;
    x(137) =  0.12647058437230196685E+00;
    x(138) =  0.14042423315256017459E+00;
    x(139) =  0.15434681148137810869E+00;
    x(140) =  0.16823525155220746498E+00;
    x(141) =  0.18208649675925219825E+00;
    x(142) =  0.19589750271110015392E+00;
    x(143) =  0.20966523824318119477E+00;
    x(144) =  0.22338668642896688163E+00;
    x(145) =  0.23705884558982972721E+00;
    x(146) =  0.25067873030348317661E+00;
    x(147) =  0.26424337241092676194E+00;
    x(148) =  0.27774982202182431507E+00;
    x(149) =  0.29119514851824668196E+00;
    x(150) =  0.30457644155671404334E+00;
    x(151) =  0.31789081206847668318E+00;
    x(152) =  0.33113539325797683309E+00;
    x(153) =  0.34430734159943802278E+00;
    x(154) =  0.35740383783153215238E+00;
    x(155) =  0.37042208795007823014E+00;
    x(156) =  0.38335932419873034692E+00;
    x(157) =  0.39621280605761593918E+00;
    x(158) =  0.40897982122988867241E+00;
    x(159) =  0.42165768662616330006E+00;
    x(160) =  0.43424374934680255800E+00;
    x(161) =  0.44673538766202847374E+00;
    x(162) =  0.45913001198983233287E+00;
    x(163) =  0.47142506587165887693E+00;
    x(164) =  0.48361802694584102756E+00;
    x(165) =  0.49570640791876146017E+00;
    x(166) =  0.50768775753371660215E+00;
    x(167) =  0.51955966153745702199E+00;
    x(168) =  0.53131974364437562397E+00;
    x(169) =  0.54296566649831149049E+00;
    x(170) =  0.55449513263193254887E+00;
    x(171) =  0.56590588542365442262E+00;
    x(172) =  0.57719571005204581484E+00;
    x(173) =  0.58836243444766254143E+00;
    x(174) =  0.59940393024224289297E+00;
    x(175) =  0.61031811371518640016E+00;
    x(176) =  0.62110294673722640294E+00;
    x(177) =  0.63175643771119423041E+00;
    x(178) =  0.64227664250975951377E+00;
    x(179) =  0.65266166541001749610E+00;
    x(180) =  0.66290966002478059546E+00;
    x(181) =  0.67301883023041847920E+00;
    x(182) =  0.68298743109107922809E+00;
    x(183) =  0.69281376977911470289E+00;
    x(184) =  0.70249620649152707861E+00;
    x(185) =  0.71203315536225203459E+00;
    x(186) =  0.72142308537009891548E+00;
    x(187) =  0.73066452124218126133E+00;
    x(188) =  0.73975604435269475868E+00;
    x(189) =  0.74869629361693660282E+00;
    x(190) =  0.75748396638051363793E+00;
    x(191) =  0.76611781930376009072E+00;
    x(192) =  0.77459666924148337704E+00;
    x(193) =  0.78291939411828301639E+00;
    x(194) =  0.79108493379984836143E+00;
    x(195) =  0.79909229096084140180E+00;
    x(196) =  0.80694053195021761186E+00;
    x(197) =  0.81462878765513741344E+00;
    x(198) =  0.82215625436498040737E+00;
    x(199) =  0.82952219463740140018E+00;
    x(200) =  0.83672593816886873550E+00;
    x(201) =  0.84376688267270860104E+00;
    x(202) =  0.85064449476835027976E+00;
    x(203) =  0.85735831088623215653E+00;
    x(204) =  0.86390793819369047715E+00;
    x(205) =  0.87029305554811390585E+00;
    x(206) =  0.87651341448470526974E+00;
    x(207) =  0.88256884024734190684E+00;
    x(208) =  0.88845923287225699889E+00;
    x(209) =  0.89418456833555902286E+00;
    x(210) =  0.89974489977694003664E+00;
    x(211) =  0.90514035881326159519E+00;
    x(212) =  0.91037115695700429250E+00;
    x(213) =  0.91543758715576504064E+00;
    x(214) =  0.92034002547001242073E+00;
    x(215) =  0.92507893290707565236E+00;
    x(216) =  0.92965485742974005667E+00;
    x(217) =  0.93406843615772578800E+00;
    x(218) =  0.93832039777959288365E+00;
    x(219) =  0.94241156519108305981E+00;
    x(220) =  0.94634285837340290515E+00;
    x(221) =  0.95011529752129487656E+00;
    x(222) =  0.95373000642576113641E+00;
    x(223) =  0.95718821610986096274E+00;
    x(224) =  0.96049126870802028342E+00;
    x(225) =  0.96364062156981213252E+00;
    x(226) =  0.96663785155841656709E+00;
    x(227) =  0.96948465950245923177E+00;
    x(228) =  0.97218287474858179658E+00;
    x(229) =  0.97473445975240266776E+00;
    x(230) =  0.97714151463970571416E+00;
    x(231) =  0.97940628167086268381E+00;
    x(232) =  0.98153114955374010687E+00;
    x(233) =  0.98351865757863272876E+00;
    x(234) =  0.98537149959852037111E+00;
    x(235) =  0.98709252795403406719E+00;
    x(236) =  0.98868475754742947994E+00;
    x(237) =  0.99015137040077015918E+00;
    x(238) =  0.99149572117810613240E+00;
    x(239) =  0.99272134428278861533E+00;
    x(240) =  0.99383196321275502221E+00;
    x(241) =  0.99483150280062100052E+00;
    x(242) =  0.99572410469840718851E+00;
    x(243) =  0.99651414591489027385E+00;
    x(244) =  0.99720625937222195908E+00;
    x(245) =  0.99780535449595727456E+00;
    x(246) =  0.99831663531840739253E+00;
    x(247) =  0.99874561446809511470E+00;
    x(248) =  0.99909812496766759766E+00;
    x(249) =  0.99938033802502358193E+00;
    x(250) =  0.99959879967191068325E+00;
    x(251) =  0.99976049092443204733E+00;
    x(252) =  0.99987288812035761194E+00;
    x(253) =  0.99994399620705437576E+00;
    x(254) =  0.99998243035489159858E+00;
    x(255) =  0.99999759637974846462E+00;

    w(  1) = 0.69379364324108267170E-05;
    w(  2) = 0.25157870384280661489E-04;
    w(  3) = 0.53275293669780613125E-04;
    w(  4) = 0.90372734658751149261E-04;
    w(  5) = 0.13575491094922871973E-03;
    w(  6) = 0.18887326450650491366E-03;
    w(  7) = 0.24921240048299729402E-03;
    w(  8) = 0.31630366082226447689E-03;
    w(  9) = 0.38974528447328229322E-03;
    w( 10) = 0.46918492424785040975E-03;
    w( 11) = 0.55429531493037471492E-03;
    w( 12) = 0.64476204130572477933E-03;
    w( 13) = 0.74028280424450333046E-03;
    w( 14) = 0.84057143271072246365E-03;
    w( 15) = 0.94536151685852538246E-03;
    w( 16) = 0.10544076228633167722E-02;
    w( 17) = 0.11674841174299594077E-02;
    w( 18) = 0.12843824718970101768E-02;
    w( 19) = 0.14049079956551446427E-02;
    w( 20) = 0.15288767050877655684E-02;
    w( 21) = 0.16561127281544526052E-02;
    w( 22) = 0.17864463917586498247E-02;
    w( 23) = 0.19197129710138724125E-02;
    w( 24) = 0.20557519893273465236E-02;
    w( 25) = 0.21944069253638388388E-02;
    w( 26) = 0.23355251860571608737E-02;
    w( 27) = 0.24789582266575679307E-02;
    w( 28) = 0.26245617274044295626E-02;
    w( 29) = 0.27721957645934509940E-02;
    w( 30) = 0.29217249379178197538E-02;
    w( 31) = 0.30730184347025783234E-02;
    w( 32) = 0.32259500250878684614E-02;
    w( 33) = 0.33803979910869203823E-02;
    w( 34) = 0.35362449977167777340E-02;
    w( 35) = 0.36933779170256508183E-02;
    w( 36) = 0.38516876166398709241E-02;
    w( 37) = 0.40110687240750233989E-02;
    w( 38) = 0.41714193769840788528E-02;
    w( 39) = 0.43326409680929828545E-02;
    w( 40) = 0.44946378920320678616E-02;
    w( 41) = 0.46573172997568547773E-02;
    w( 42) = 0.48205888648512683476E-02;
    w( 43) = 0.49843645647655386012E-02;
    w( 44) = 0.51485584789781777618E-02;
    w( 45) = 0.53130866051870565663E-02;
    w( 46) = 0.54778666939189508240E-02;
    w( 47) = 0.56428181013844441585E-02;
    w( 48) = 0.58078616599775673635E-02;
    w( 49) = 0.59729195655081658049E-02;
    w( 50) = 0.61379152800413850435E-02;
    w( 51) = 0.63027734490857587172E-02;
    w( 52) = 0.64674198318036867274E-02;
    w( 53) = 0.66317812429018878941E-02;
    w( 54) = 0.67957855048827733948E-02;
    w( 55) = 0.69593614093904229394E-02;
    w( 56) = 0.71224386864583871532E-02;
    w( 57) = 0.72849479805538070639E-02;
    w( 58) = 0.74468208324075910174E-02;
    w( 59) = 0.76079896657190565832E-02;
    w( 60) = 0.77683877779219912200E-02;
    w( 61) = 0.79279493342948491103E-02;
    w( 62) = 0.80866093647888599710E-02;
    w( 63) = 0.82443037630328680306E-02;
    w( 64) = 0.84009692870519326354E-02;
    w( 65) = 0.85565435613076896192E-02;
    w( 66) = 0.87109650797320868736E-02;
    w( 67) = 0.88641732094824942641E-02;
    w( 68) = 0.90161081951956431600E-02;
    w( 69) = 0.91667111635607884067E-02;
    w( 70) = 0.93159241280693950932E-02;
    w( 71) = 0.94636899938300652943E-02;
    w( 72) = 0.96099525623638830097E-02;
    w( 73) = 0.97546565363174114611E-02;
    w( 74) = 0.98977475240487497440E-02;
    w( 75) = 0.10039172044056840798E-01;
    w( 76) = 0.10178877529236079733E-01;
    w( 77) = 0.10316812330947621682E-01;
    w( 78) = 0.10452925722906011926E-01;
    w( 79) = 0.10587167904885197931E-01;
    w( 80) = 0.10719490006251933623E-01;
    w( 81) = 0.10849844089337314099E-01;
    w( 82) = 0.10978183152658912470E-01;
    w( 83) = 0.11104461134006926537E-01;
    w( 84) = 0.11228632913408049354E-01;
    w( 85) = 0.11350654315980596602E-01;
    w( 86) = 0.11470482114693874380E-01;
    w( 87) = 0.11588074033043952568E-01;
    w( 88) = 0.11703388747657003101E-01;
    w( 89) = 0.11816385890830235763E-01;
    w( 90) = 0.11927026053019270040E-01;
    w( 91) = 0.12035270785279562630E-01;
    w( 92) = 0.12141082601668299679E-01;
    w( 93) = 0.12244424981611985899E-01;
    w( 94) = 0.12345262372243838455E-01;
    w( 95) = 0.12443560190714035263E-01;
    w( 96) = 0.12539284826474884353E-01;
    w( 97) = 0.12632403643542078765E-01;
    w( 98) = 0.12722884982732382906E-01;
    w( 99) = 0.12810698163877361967E-01;
    w(100) = 0.12895813488012114694E-01;
    w(101) = 0.12978202239537399286E-01;
    w(102) = 0.13057836688353048840E-01;
    w(103) = 0.13134690091960152836E-01;
    w(104) = 0.13208736697529129966E-01;
    w(105) = 0.13279951743930530650E-01;
    w(106) = 0.13348311463725179953E-01;
    w(107) = 0.13413793085110098513E-01;
    w(108) = 0.13476374833816515982E-01;
    w(109) = 0.13536035934956213614E-01;
    w(110) = 0.13592756614812395910E-01;
    w(111) = 0.13646518102571291428E-01;
    w(112) = 0.13697302631990716258E-01;
    w(113) = 0.13745093443001896632E-01;
    w(114) = 0.13789874783240936517E-01;
    w(115) = 0.13831631909506428676E-01;
    w(116) = 0.13870351089139840997E-01;
    w(117) = 0.13906019601325461264E-01;
    w(118) = 0.13938625738306850804E-01;
    w(119) = 0.13968158806516938516E-01;
    w(120) = 0.13994609127619079852E-01;
    w(121) = 0.14017968039456608810E-01;
    w(122) = 0.14038227896908623303E-01;
    w(123) = 0.14055382072649964277E-01;
    w(124) = 0.14069424957813575318E-01;
    w(125) = 0.14080351962553661325E-01;
    w(126) = 0.14088159516508301065E-01;
    w(127) = 0.14092845069160408355E-01;
    w(128) = 0.14094407090096179347E-01;
    w(129) = 0.14092845069160408355E-01;
    w(130) = 0.14088159516508301065E-01;
    w(131) = 0.14080351962553661325E-01;
    w(132) = 0.14069424957813575318E-01;
    w(133) = 0.14055382072649964277E-01;
    w(134) = 0.14038227896908623303E-01;
    w(135) = 0.14017968039456608810E-01;
    w(136) = 0.13994609127619079852E-01;
    w(137) = 0.13968158806516938516E-01;
    w(138) = 0.13938625738306850804E-01;
    w(139) = 0.13906019601325461264E-01;
    w(140) = 0.13870351089139840997E-01;
    w(141) = 0.13831631909506428676E-01;
    w(142) = 0.13789874783240936517E-01;
    w(143) = 0.13745093443001896632E-01;
    w(144) = 0.13697302631990716258E-01;
    w(145) = 0.13646518102571291428E-01;
    w(146) = 0.13592756614812395910E-01;
    w(147) = 0.13536035934956213614E-01;
    w(148) = 0.13476374833816515982E-01;
    w(149) = 0.13413793085110098513E-01;
    w(150) = 0.13348311463725179953E-01;
    w(151) = 0.13279951743930530650E-01;
    w(152) = 0.13208736697529129966E-01;
    w(153) = 0.13134690091960152836E-01;
    w(154) = 0.13057836688353048840E-01;
    w(155) = 0.12978202239537399286E-01;
    w(156) = 0.12895813488012114694E-01;
    w(157) = 0.12810698163877361967E-01;
    w(158) = 0.12722884982732382906E-01;
    w(159) = 0.12632403643542078765E-01;
    w(160) = 0.12539284826474884353E-01;
    w(161) = 0.12443560190714035263E-01;
    w(162) = 0.12345262372243838455E-01;
    w(163) = 0.12244424981611985899E-01;
    w(164) = 0.12141082601668299679E-01;
    w(165) = 0.12035270785279562630E-01;
    w(166) = 0.11927026053019270040E-01;
    w(167) = 0.11816385890830235763E-01;
    w(168) = 0.11703388747657003101E-01;
    w(169) = 0.11588074033043952568E-01;
    w(170) = 0.11470482114693874380E-01;
    w(171) = 0.11350654315980596602E-01;
    w(172) = 0.11228632913408049354E-01;
    w(173) = 0.11104461134006926537E-01;
    w(174) = 0.10978183152658912470E-01;
    w(175) = 0.10849844089337314099E-01;
    w(176) = 0.10719490006251933623E-01;
    w(177) = 0.10587167904885197931E-01;
    w(178) = 0.10452925722906011926E-01;
    w(179) = 0.10316812330947621682E-01;
    w(180) = 0.10178877529236079733E-01;
    w(181) = 0.10039172044056840798E-01;
    w(182) = 0.98977475240487497440E-02;
    w(183) = 0.97546565363174114611E-02;
    w(184) = 0.96099525623638830097E-02;
    w(185) = 0.94636899938300652943E-02;
    w(186) = 0.93159241280693950932E-02;
    w(187) = 0.91667111635607884067E-02;
    w(188) = 0.90161081951956431600E-02;
    w(189) = 0.88641732094824942641E-02;
    w(190) = 0.87109650797320868736E-02;
    w(191) = 0.85565435613076896192E-02;
    w(192) = 0.84009692870519326354E-02;
    w(193) = 0.82443037630328680306E-02;
    w(194) = 0.80866093647888599710E-02;
    w(195) = 0.79279493342948491103E-02;
    w(196) = 0.77683877779219912200E-02;
    w(197) = 0.76079896657190565832E-02;
    w(198) = 0.74468208324075910174E-02;
    w(199) = 0.72849479805538070639E-02;
    w(200) = 0.71224386864583871532E-02;
    w(201) = 0.69593614093904229394E-02;
    w(202) = 0.67957855048827733948E-02;
    w(203) = 0.66317812429018878941E-02;
    w(204) = 0.64674198318036867274E-02;
    w(205) = 0.63027734490857587172E-02;
    w(206) = 0.61379152800413850435E-02;
    w(207) = 0.59729195655081658049E-02;
    w(208) = 0.58078616599775673635E-02;
    w(209) = 0.56428181013844441585E-02;
    w(210) = 0.54778666939189508240E-02;
    w(211) = 0.53130866051870565663E-02;
    w(212) = 0.51485584789781777618E-02;
    w(213) = 0.49843645647655386012E-02;
    w(214) = 0.48205888648512683476E-02;
    w(215) = 0.46573172997568547773E-02;
    w(216) = 0.44946378920320678616E-02;
    w(217) = 0.43326409680929828545E-02;
    w(218) = 0.41714193769840788528E-02;
    w(219) = 0.40110687240750233989E-02;
    w(220) = 0.38516876166398709241E-02;
    w(221) = 0.36933779170256508183E-02;
    w(222) = 0.35362449977167777340E-02;
    w(223) = 0.33803979910869203823E-02;
    w(224) = 0.32259500250878684614E-02;
    w(225) = 0.30730184347025783234E-02;
    w(226) = 0.29217249379178197538E-02;
    w(227) = 0.27721957645934509940E-02;
    w(228) = 0.26245617274044295626E-02;
    w(229) = 0.24789582266575679307E-02;
    w(230) = 0.23355251860571608737E-02;
    w(231) = 0.21944069253638388388E-02;
    w(232) = 0.20557519893273465236E-02;
    w(233) = 0.19197129710138724125E-02;
    w(234) = 0.17864463917586498247E-02;
    w(235) = 0.16561127281544526052E-02;
    w(236) = 0.15288767050877655684E-02;
    w(237) = 0.14049079956551446427E-02;
    w(238) = 0.12843824718970101768E-02;
    w(239) = 0.11674841174299594077E-02;
    w(240) = 0.10544076228633167722E-02;
    w(241) = 0.94536151685852538246E-03;
    w(242) = 0.84057143271072246365E-03;
    w(243) = 0.74028280424450333046E-03;
    w(244) = 0.64476204130572477933E-03;
    w(245) = 0.55429531493037471492E-03;
    w(246) = 0.46918492424785040975E-03;
    w(247) = 0.38974528447328229322E-03;
    w(248) = 0.31630366082226447689E-03;
    w(249) = 0.24921240048299729402E-03;
    w(250) = 0.18887326450650491366E-03;
    w(251) = 0.13575491094922871973E-03;
    w(252) = 0.90372734658751149261E-04;
    w(253) = 0.53275293669780613125E-04;
    w(254) = 0.25157870384280661489E-04;
    w(255) = 0.69379364324108267170E-05;

  else

    fprintf ( 1, '\n' );
    fprintf ( 1, 'PATTERSON_SET - Fatal error!\n' );
    fprintf ( 1, '  Illegal input value of ORDER.\n' );
    fprintf ( 1, '  Order must be 1, 3, 7, 15, 31, 63, 127, or 255.\n' );
    error ( 'PATTERSON_SET - Fatal error!' );

  end

  return
end
function r8mat_write ( output_filename, m, n, table )

%*****************************************************************************80
%
%% R8MAT_WRITE writes an R8MAT file.
%
%  Licensing:
%
%    This code is distributed under the GNU LGPL license.
%
%  Modified:
%
%    11 August 2009
%
%  Author:
%
%    John Burkardt
%
%  Parameters:
%
%    Input, string OUTPUT_FILENAME, the output filename.
%
%    Input, integer M, the spatial dimension.
%
%    Input, integer N, the number of points.
%
%    Input, real TABLE(M,N), the points.
%

%
%  Open the file.
%
  output_unit = fopen ( output_filename, 'wt' );

  if ( output_unit < 0 ) 
    fprintf ( 1, '\n' );
    fprintf ( 1, 'R8MAT_WRITE - Error!\n' );
    fprintf ( 1, '  Could not open the output file.\n' );
    error ( 'R8MAT_WRITE - Error!' );
  end
%
%  Write the data.
%
%  For smaller data files, and less precision, try:
%
%     fprintf ( output_unit, '  %14.6f', table(i,j) );
%
  for j = 1 : n
    for i = 1 : m
      fprintf ( output_unit, '  %24.16f', table(i,j) );
    end
    fprintf ( output_unit, '\n' );
  end
%
%  Close the file.
%
  fclose ( output_unit );

  return
end
function [ x, w ] = rescale ( a, b, x, w )

%*****************************************************************************80
%
%% RESCALE rescales a Legendre quadrature rule from [-1,+1] to [A,B].
%
%  Licensing:
%
%    This code is distributed under the GNU LGPL license. 
%
%  Modified:
%
%    21 October 2009
%
%  Author:
%
%    John Burkardt.
%
%  Reference:
%
%    Andreas Glaser, Xiangtao Liu, Vladimir Rokhlin, 
%    A fast algorithm for the calculation of the roots of special functions, 
%    SIAM Journal on Scientific Computing,
%    Volume 29, Number 4, pages 1420-1438, 2007.
%
%  Parameters:
%
%    Input, real A, B, the endpoints of the new interval.
%
%    Input, integer N, the order.
%
%    Input, real X(N), the abscissas for [-1,+1].
%
%    Input, real W(N), the weights for [-1,+1].
%
%    Output, real X(N), the abscissas for [A,B].
%
%    Output, real W(N), the weights for [A,B].
%
  x = 0.5 * ( ( x + 1.0 ) * b - ( x - 1.0 ) * a );

  w = 0.5 * ( b - a ) * w;

  return
end
function rule_write ( order, filename, x, w, r )

%*****************************************************************************80
%
%% RULE_WRITE writes a quadrature rule to a file.
%
%  Licensing:
%
%    This code is distributed under the GNU LGPL license.
%
%  Modified:
%
%    18 February 2010
%
%  Author:
%
%    John Burkardt
%
%  Parameters:
%
%    Input, integer ORDER, the order of the rule.
%
%    Input, string FILENAME, specifies the output files.
%    write files 'filename_w.txt', 'filename_x.txt', 'filename_r.txt' defining 
%    weights, abscissas, and region.
%
%    Input, real X(ORDER), the abscissas.
%
%    Input, real W(ORDER), the weights.
%
%    Input, real R(2), the region.
%
  filename_x = strcat ( filename, '_x.txt' );
  filename_w = strcat ( filename, '_w.txt' );
  filename_r = strcat ( filename, '_r.txt' );

%% The following code initially was uncommented
%   fprintf ( 1, '\n' );
%   fprintf ( 1,'  Creating quadrature files.\n' );
%   fprintf ( 1, '\n' );
%   fprintf ( 1, '  "Root" file name is   "%s".\n', filename );
%   fprintf ( 1, '\n' );
%   fprintf ( 1, '  Weight file will be   "%s".\n', filename_w );
%   fprintf ( 1, '  Abscissa file will be "%s".\n', filename_x );
%   fprintf ( 1, '  Region file will be   "%s".\n', filename_r );
%%

  r8mat_write ( filename_w, 1, order, w' );
  r8mat_write ( filename_x, 1, order, x' );
  r8mat_write ( filename_r, 1, 2,     r' );

  return
end
function timestamp ( )

%*****************************************************************************80
%
%% TIMESTAMP prints the current YMDHMS date as a timestamp.
%
%  Licensing:
%
%    This code is distributed under the GNU LGPL license.
%
%  Modified:
%
%    14 February 2003
%
%  Author:
%
%    John Burkardt
%
  t = now;
  c = datevec ( t );
  s = datestr ( c, 0 );
  fprintf ( 1, '%s\n', s );

  return
end
